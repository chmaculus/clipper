SET CURSOR OFF
SALE=0
DO WHILE .T.
   SET COLOR TO W+/B
   @22,16 CLEAR TO 24,61 
   @22,16 TO 24,61 
   @23,21 SAY 'Prepare la Impresora y pulse <ENTER>'
   SET COLOR TO BG+/B
   @23,50 SAY '<ENTER>'
   SET COLOR TO W+/B
   INKEY(0)
   IF LASTKEY()=27
      SALE=1
      EXIT
   ENDIF
   SET COLOR TO
   IF ISPRINTER()
      EXIT
   ELSE
      SET COLOR TO W+/B
      TONE(500,2)
      @23,17 CLEAR TO 23,60 
      @23,20 SAY 'La Impresora NO ESTA LISTA...'
      set color to *RG+/B
      @23,49 SAY 'VERIFIQUE'
      INKEY(3)
      SET COLOR TO W+/B
      LOOP
   ENDIF
ENDDO
IF SALE=1
   RETURN
ENDIF

IF VIVA='RI'
   STORE 3 TO CPRIN
ELSE
   STORE 2 TO CPRIN
ENDIF

SET COLOR TO W+/B
@22,17 CLEAR TO 22,60
SET CURSOR OFF
SET COLOR TO *RG+/B
@22,24 SAY 'ESTOY IMPRIMIENDO....­ ESPERATE !'
SET COLOR TO W+/B
SET DEVICE TO PRINT
inicio=chr(27)+chr(67)+chr(36)
@0,0 SAY inicio
FOR K=1 TO CPRIN
   STORE 0 TO TTT
   @2,54 SAY 'NOTA DE CREDITO'
   @3,54 SAY DATE()
   @9,7 SAY VNOMBRE
   @10,7 SAY VDOMI
   IF VIVA='RI'
      VVI='RESPONSABLE INSCRIPTO'
   ELSEIF VIVA='NR'
      VVI='NO RESPONSABLE'
   ELSEIF VIVA='MT'
      VVI='MONOTRIBUTISTA'
   ELSEIF VIVA='EX'
      VVI='EXENTO'
   ELSE
      VVI='CONSUMIDOR FINAL'
   ENDIF
   @12,7 SAY VVI
   @12,52 SAY VCUIT PICTURE '99-99999999-9'
   @14,13 SAY 'NOTA DE CREDITO'
   @17,2 SAY '1'
   @17,16 SAY ESNOTA
   @17,58 SAY VALOR PICTURE '9999.99'
   @17,70 SAY VALOR PICTURE '9999.99'
   @30,4 SAY VALOR PICTURE '9999.99'
   @30,30 SAY VALOR PICTURE '9999.99'
   @30,43 SAY 0 PICTURE '9'
   @30,58 SAY 0 PICTURE '9'
   @30,70 SAY VALOR PICTURE '9999.99'
   EJECT
NEXT
SET DEVICE TO SCREEN
RETURN
