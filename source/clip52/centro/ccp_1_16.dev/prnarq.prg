#include "colores.ch"
SET CURSOR OFF
SET COLOR TO COLOR0
SALE=0
DO WHILE .T.
   @22,16 CLEAR TO 24,61 
   SET COLOR TO COLOR0
   @22,16 TO 24,61 
   @23,21 SAY 'Prepare la Impresora y pulse <ENTER>'
   SET COLOR TO COLOR6
   @23,50 SAY '<ENTER>'
   SET COLOR TO COLOR0
   INKEY(0)
   IF LASTKEY()=27
      SALE=1
      EXIT
   ENDIF
   SET COLOR TO COLOR0
   IF ISPRINTER()
      EXIT
   ELSE
      TONE(500,2)
      @23,17 CLEAR TO 23,60 
      set color to COLOR0
      @23,20 SAY 'La Impresora NO ESTA LISTA...'
      set color to COLOR8
      @23,49 SAY 'PELOTUDA!'
      INKEY(3)
      SET COLOR TO COLOR0
      LOOP
   ENDIF
ENDDO
IF SALE=1
   RETURN
ENDIF
numero=LEFT(DTOC(DATE()),2)
DIA=TDIAS(cdow(DATE()))
MES=TMES(CMONTH(DATE()))
ANIO=ALLTRIM(STR(YEAR(DATE())))
VFECHA=DIA+' '+numero+' de '+MES+' de '+ANIO
SET COLOR TO COLOR0
@23,17 CLEAR TO 23,60
SET CURSOR OFF
SET COLOR TO COLOR9
@23,24 SAY 'ESTOY IMPRIMIENDO....­ ESPERATE !'
SET COLOR TO COLOR0
SET DEVICE TO PRINT
@0,0 SAY 'ESTACION DE SERVICIO CENTRO'
LL=79-LEN(VFECHA)
@0,LL-7 SAY 'Fecha: '
@0,LL SAY VFECHA
@2,33 SAY 'ARQUEOS DE CAJAS'
@3,1 SAY REPLICATE('Ä',78)
@4,0 SAY '³  Fechas  ³Total Ventas³Total Gastos³Deber¡a Haber³Dinero Existente³Diferencia³'
@5,1 SAY REPLICATE('Ä',78)
LINEA=6
IF TODOS=0
   @LINEA,0 SAY '³'
   @LINEA,2 SAY FECHA PICTURE '99/99/99'
   @LINEA,11 SAY '³'
   @LINEA,16 SAY TOTVENTAS PICTURE '9999.999'
   @LINEA,24 SAY '³'
   @LINEA,29 SAY TOTGASTOS PICTURE '9999.999'
   @LINEA,37 SAY '³'
   @LINEA,43 SAY DEBERIA PICTURE '9999.999'
   @LINEA,51 SAY '³'
   @LINEA,59 SAY ENCAJA PICTURE '9999.999'
   @LINEA,68 SAY '³'
   DIFERENCIA=ENCAJA-DEBERIA
   @LINEA,71 SAY DIFERENCIA PICTURE '9999.999'
   @LINEA,79 SAY '³'
   LINEA=LINEA+1
   @LINEA,1 SAY REPLICATE('Ä',78)
ELSE
   DO WHILE .T.
      IF EOF()
         EXIT
      ENDIF
      @LINEA,0 SAY '³'
      @LINEA,2 SAY FECHA PICTURE '99/99/99'
      @LINEA,11 SAY '³'
      @LINEA,16 SAY TOTVENTAS PICTURE '9999.999'
      @LINEA,24 SAY '³'
      @LINEA,29 SAY TOTGASTOS PICTURE '9999.999'
      @LINEA,37 SAY '³'
      @LINEA,43 SAY DEBERIA PICTURE '9999.999'
      @LINEA,51 SAY '³'
      @LINEA,59 SAY ENCAJA PICTURE '9999.999'
      @LINEA,68 SAY '³'
      DIFERENCIA=DEBERIA-ENCAJA
      @LINEA,71 SAY DIFERENCIA PICTURE '9999.999'
      @LINEA,79 SAY '³'
      LINEA=LINEA+1
      SKIP
      LOOP
   ENDDO
   @LINEA,1 SAY REPLICATE('Ä',78)
ENDIF
EJECT
SET DEVICE TO SCREEN
CLOSE ALL
RETURN
